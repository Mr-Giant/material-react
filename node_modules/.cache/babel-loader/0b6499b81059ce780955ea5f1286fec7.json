{"ast":null,"code":"import _classCallCheck from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _taggedTemplateLiteral from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/src/views/login/Login.js\";\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"position:relative;\\n    margin-bottom:12px;\\n    padding:6px 0;\\n    background:#fff;\\n    input{\\n        padding:6px 15px;\\n        font-size:14px;\\n        color:#aaa;\\n        cursor:pointer;\\n        background:#fff;\\n        border:none;\\n        outline:medium;\\n        &:focus+.line{\\n            transform:scaleX(1);\\n        }\\n    }\\n    .line{\\n        position:absolute;\\n        width:100%;\\n        height:4px;\\n        background:\", \";\\n        left:0;\\n        top:0;\\n        transform:scaleX(0);\\n        transition:transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;\\n    }\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    width:260px;\\n    height:200px;\\n    position:absolute;\\n    left:0;\\n    top:0;\\n    right:0;\\n    bottom: 0;\\n    margin:auto;\\n    cursor:pointer;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    position:fixed;\\n    width:100%;\\n    height:100%;\\n    z-index:\", \";\\n    background-image: radial-gradient(ellipse farthest-corner at center top, \", \" 0%, #000105 100%);\\n    cursor: move;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { CanvasBg } from '../../canvas'; // 自定义的组件\n\nimport NoticeMessage from 'components/Notifications/NoticeMessage.jsx'; // global common style\n\nimport { levelOneZindex, ClearFix, themeRgbaColor } from 'components/common-style'; // material-button\n\nimport Button from \"components/CustomButtons/Button.js\"; // react-actions\n\nimport { fetchPermissionRoute, setLogin } from '../../store/modules/account/action';\nvar loginBtnBg = \"#00acc1\"; // login box\n\nvar LoginBgBox = styled(ClearFix)(_templateObject(), levelOneZindex, themeRgbaColor); // login form\n\nvar FormBox = styled.div(_templateObject2());\nvar FormList = styled.div(_templateObject3(), loginBtnBg);\n\nvar Login = /*#__PURE__*/function (_PureComponent) {\n  _inherits(Login, _PureComponent);\n\n  var _super = _createSuper(Login);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _super.call(this, props);\n\n    _this.updateUserName = function (e) {\n      var userName = e.target.value;\n\n      _this.setState({\n        userName: userName\n      });\n    };\n\n    _this.updateUserPwd = function (e) {\n      var userPwd = e.target.value;\n\n      _this.setState({\n        userPwd: userPwd\n      });\n    };\n\n    _this.resetInputType = function () {\n      var type = _this.state.type;\n      var newType = type === \"text\" ? \"password\" : type;\n\n      _this.setState({\n        type: newType\n      });\n    };\n\n    _this.keyUpEnter = function (e) {\n      var keyCode = e.keyCode;\n\n      if (keyCode && keyCode === 13) {\n        _this.login(e);\n      }\n    };\n\n    _this.login = function (e) {\n      var _this$state = _this.state,\n          userName = _this$state.userName,\n          userPwd = _this$state.userPwd;\n      var zhReg = new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\");\n\n      if (!userName) {\n        return _this.showMessage(\"warning\");\n      }\n\n      if (userName && zhReg.test(userName)) {\n        return _this.setState({\n          messageType: \"error\",\n          message: \"Username cannot contain Chinese !\",\n          animationName: \"bounce\"\n        });\n      }\n\n      if (!userPwd) {\n        return _this.showMessage(\"error\");\n      }\n\n      if (userName && userPwd) {\n        var history = _this.props.history;\n        var permissionId = 6; // 权限控制\n\n        var info = {\n          userName: userName,\n          userPwd: userPwd,\n          permissionId: permissionId\n        };\n\n        _this.props.setLogin(info); //保存到sessionStorage并保存登录状态\n\n\n        _this.resetInputType(); // input 设置默认状态\n\n\n        _this.props.fetchPermissionRoute(permissionId); // 根据权限获取路由\n        // back to home\n\n\n        history.push(\"/\"); // console.log('IP信息是：', returnCitySN)\n      }\n    };\n\n    _this.removeNotification = function () {\n      _this.setState({\n        message: null,\n        type: null\n      });\n    };\n\n    _this.state = {\n      type: \"text\",\n      userName: \"\",\n      userPwd: \"\",\n      // default state value\n      message: null,\n      messageType: null,\n      animationName: null\n    };\n    _this.messageInfo = {\n      success: {\n        message: \"登录成功\",\n        animationName: null\n      },\n      warning: {\n        message: \"用户名不能为空！\",\n        animationName: \"slideInLeft\"\n      },\n      error: {\n        message: \"密码不能为空！\",\n        animationName: \"shake\"\n      }\n    };\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      new CanvasBg(\"canvasMoveBg\");\n    }\n  }, {\n    key: \"showMessage\",\n    value: function showMessage(messageType) {\n      var _this$messageInfo$mes = this.messageInfo[messageType],\n          message = _this$messageInfo$mes.message,\n          animationName = _this$messageInfo$mes.animationName;\n      this.setState({\n        messageType: messageType,\n        message: message,\n        animationName: animationName\n      });\n    } // remove notifications callback\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          type = _this$state2.type,\n          userName = _this$state2.userName,\n          userPwd = _this$state2.userPwd,\n          message = _this$state2.message,\n          messageType = _this$state2.messageType,\n          animationName = _this$state2.animationName;\n      return /*#__PURE__*/React.createElement(LoginBgBox, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 7\n        }\n      }, message ? /*#__PURE__*/React.createElement(NoticeMessage, {\n        message: message,\n        type: messageType,\n        animation: animationName,\n        removeAlert: this.removeNotification,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 13\n        }\n      }) : null, /*#__PURE__*/React.createElement(\"canvas\", {\n        id: \"canvasMoveBg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(FormBox, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(FormList, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        className: \"user-name\",\n        autoComplete: \"off\",\n        type: \"text\",\n        value: userName,\n        placeholder: \"\\u8D26\\u53F7\",\n        maxLength: \"10\",\n        onChange: this.updateUserName,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(FormList, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        className: \"user-pwd\",\n        autoComplete: \"off\",\n        type: type,\n        value: userPwd,\n        placeholder: \"\\u5BC6\\u7801\",\n        maxLength: \"10\",\n        onFocus: this.resetInputType,\n        onChange: this.updateUserPwd,\n        onKeyUp: this.keyUpEnter,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(Button, {\n        style: {\n          width: \"100%\",\n          fontSize: \"14px\"\n        },\n        color: \"info\",\n        onClick: this.login,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }\n      }, \"\\u767B\\u5F55\")));\n    }\n  }]);\n\n  return Login;\n}(PureComponent);\n\nvar mapDispatchToProps = {\n  fetchPermissionRoute: fetchPermissionRoute,\n  setLogin: setLogin\n};\nexport default withRouter(connect(null, mapDispatchToProps)(Login));","map":{"version":3,"sources":["/Users/zhangfan/dav/Takeaway/material-dashboard-react/src/views/login/Login.js"],"names":["React","PureComponent","connect","withRouter","styled","CanvasBg","NoticeMessage","levelOneZindex","ClearFix","themeRgbaColor","Button","fetchPermissionRoute","setLogin","loginBtnBg","LoginBgBox","FormBox","div","FormList","Login","props","updateUserName","e","userName","target","value","setState","updateUserPwd","userPwd","resetInputType","type","state","newType","keyUpEnter","keyCode","login","zhReg","RegExp","showMessage","test","messageType","message","animationName","history","permissionId","info","push","removeNotification","messageInfo","success","warning","error","width","fontSize","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport styled from 'styled-components'\nimport { CanvasBg } from '../../canvas'\n// 自定义的组件\nimport NoticeMessage from 'components/Notifications/NoticeMessage.jsx'\n// global common style\nimport {\n  levelOneZindex,\n  ClearFix,\n  themeRgbaColor,\n} from 'components/common-style';\n// material-button\nimport Button from \"components/CustomButtons/Button.js\";\n\n\n// react-actions\nimport {\n  fetchPermissionRoute,\n  setLogin\n} from '../../store/modules/account/action'\n\nconst loginBtnBg = \"#00acc1\"\n// login box\nconst LoginBgBox = styled(ClearFix)`\n    position:fixed;\n    width:100%;\n    height:100%;\n    z-index:${levelOneZindex};\n    background-image: radial-gradient(ellipse farthest-corner at center top, ${themeRgbaColor} 0%, #000105 100%);\n    cursor: move;\n`\n// login form\nconst FormBox = styled.div`\n    width:260px;\n    height:200px;\n    position:absolute;\n    left:0;\n    top:0;\n    right:0;\n    bottom: 0;\n    margin:auto;\n    cursor:pointer;\n`\nconst FormList = \nstyled.div`position:relative;\n    margin-bottom:12px;\n    padding:6px 0;\n    background:#fff;\n    input{\n        padding:6px 15px;\n        font-size:14px;\n        color:#aaa;\n        cursor:pointer;\n        background:#fff;\n        border:none;\n        outline:medium;\n        &:focus+.line{\n            transform:scaleX(1);\n        }\n    }\n    .line{\n        position:absolute;\n        width:100%;\n        height:4px;\n        background:${loginBtnBg};\n        left:0;\n        top:0;\n        transform:scaleX(0);\n        transition:transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;\n    }`\n\nclass Login extends PureComponent {\n  constructor(props) {\n    super(props)\n    this.state = {\n      type: \"text\",\n      userName: \"\",\n      userPwd: \"\",\n      // default state value\n      message: null,\n      messageType: null,\n      animationName: null,\n    }\n    this.messageInfo = {\n      success: {\n        message: \"登录成功\",\n        animationName: null\n      },\n      warning: {\n        message: \"用户名不能为空！\",\n        animationName: \"slideInLeft\"\n      },\n      error: {\n        message: \"密码不能为空！\",\n        animationName: \"shake\",\n      },\n    }\n  }\n\n  componentDidMount() {\n    new CanvasBg(\"canvasMoveBg\")\n  }\n\n  updateUserName = e => {\n    const userName = e.target.value\n    this.setState({ userName })\n  }\n\n  updateUserPwd = e => {\n    const userPwd = e.target.value\n    this.setState({ userPwd })\n  }\n\n  // 在聚焦时重置输入类型，以防止浏览器记住密码\n  resetInputType = () => {\n    const { type } = this.state\n    const newType = type === \"text\" ? \"password\" : type\n    this.setState({\n      type: newType\n    })\n  }\n\n  keyUpEnter = (e) => {\n    const { keyCode } = e\n    if (keyCode && keyCode === 13) {\n      this.login(e)\n    }\n  }\n\n  login = (e) => {\n    const { userName, userPwd } = this.state\n    const zhReg = new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\")\n    if (!userName) {\n      return this.showMessage(\"warning\")\n    }\n    if (userName && zhReg.test(userName)) {\n      return this.setState({\n        messageType: \"error\",\n        message: \"Username cannot contain Chinese !\",\n        animationName: \"bounce\",\n      })\n    }\n    if (!userPwd) {\n      return this.showMessage(\"error\")\n    }\n    if (userName && userPwd) {\n      const { history } = this.props\n      const permissionId = 6 // 权限控制\n      const info = { userName, userPwd, permissionId }\n      this.props.setLogin(info) //保存到sessionStorage并保存登录状态\n      this.resetInputType() // input 设置默认状态\n      this.props.fetchPermissionRoute(permissionId) // 根据权限获取路由\n      // back to home\n      history.push(\"/\")\n      // console.log('IP信息是：', returnCitySN)\n    }\n  }\n\n  showMessage(messageType) {\n    const { message, animationName } = this.messageInfo[messageType]\n    this.setState({ messageType, message, animationName })\n  }\n\n  // remove notifications callback\n  removeNotification = () => {\n    this.setState({ message: null, type: null })\n  }\n\n  render() {\n    const { type, userName, userPwd, message, messageType, animationName } = this.state\n    return (\n      <LoginBgBox>\n        {\n          message ?\n            <NoticeMessage message={message}\n              type={messageType}\n              animation={animationName}\n              removeAlert={this.removeNotification} /> : null\n        }\n        <canvas id=\"canvasMoveBg\" />\n        <FormBox>\n          <FormList>\n            <input className=\"user-name\"\n              autoComplete=\"off\"\n              type=\"text\"\n              value={userName}\n              placeholder=\"账号\"\n              maxLength=\"10\"\n              onChange={this.updateUserName} />\n            <div className=\"line\" />\n          </FormList>\n          <FormList>\n            <input className=\"user-pwd\"\n              autoComplete=\"off\"\n              type={type}\n              value={userPwd}\n              placeholder=\"密码\"\n              maxLength=\"10\"\n              onFocus={this.resetInputType}\n              onChange={this.updateUserPwd}\n              onKeyUp={this.keyUpEnter} />\n            <div className=\"line\" />\n          </FormList>\n          <Button style={{ width: \"100%\", fontSize: \"14px\" }} color=\"info\" onClick={this.login}>登录</Button>\n        </FormBox>\n      </LoginBgBox>\n    )\n  }\n}\n\nconst mapDispatchToProps = {\n  fetchPermissionRoute,\n  setLogin,\n}\n\nexport default withRouter(connect(null, mapDispatchToProps)(Login))\n"]},"metadata":{},"sourceType":"module"}