{"ast":null,"code":"import _defineProperty from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/zhangfan/dav/Takeaway/material-dashboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _handleActions;\n\nimport { handleActions } from 'redux-actions';\nimport { sessionStore } from '../../../utils/index';\nimport routeList from '../../../routes';\nimport { setLogin, setLoginOut, fetchPermissionRoute } from './action';\nexport var namespace = 'account';\nvar info = sessionStore.fetch();\nexport var defaultState = {\n  temp: 'account',\n  storeTips: 'account store module',\n  userInfo: info,\n  loginState: info && Object.keys(info).length ? 1 : 0,\n  routeList: []\n};\nexport var accountReducer = handleActions((_handleActions = {}, _defineProperty(_handleActions, setLogin, function (state, action) {\n  var info = action.payload.info;\n  var status = 0;\n\n  if (info && Object.keys(info).length) {\n    sessionStore.save(info);\n    status = 1;\n  } // let status = (info && Object.keys(info).length) ? 1 : 0\n\n\n  return _objectSpread(_objectSpread({}, state), {}, {\n    loginState: status,\n    userInfo: info\n  });\n}), _defineProperty(_handleActions, setLoginOut, function (state) {\n  sessionStore.remove();\n  console.error(_objectSpread(_objectSpread({}, state), {}, {\n    loginState: 0,\n    userInfo: null,\n    routeList: []\n  }));\n  return _objectSpread(_objectSpread({}, state), {}, {\n    loginState: 0,\n    userInfo: null,\n    routeList: []\n  });\n}), _defineProperty(_handleActions, fetchPermissionRoute, function (state, action) {\n  var _ref = action.payload || {},\n      permissionId = _ref.permissionId;\n\n  console.log(action, ' 权限路由匹配成功..');\n  var list = routeList.filter(function (item) {\n    return item.permission <= permissionId;\n  });\n  console.error(_objectSpread(_objectSpread({}, state), {}, {\n    routeList: _toConsumableArray(list)\n  }));\n  return _objectSpread(_objectSpread({}, state), {}, {\n    routeList: _toConsumableArray(list)\n  });\n}), _handleActions), defaultState);","map":{"version":3,"sources":["/Users/zhangfan/dav/Takeaway/material-dashboard-react/src/store/modules/account/reducer.js"],"names":["handleActions","sessionStore","routeList","setLogin","setLoginOut","fetchPermissionRoute","namespace","info","fetch","defaultState","temp","storeTips","userInfo","loginState","Object","keys","length","accountReducer","state","action","payload","status","save","remove","console","error","permissionId","log","list","filter","item","permission"],"mappings":";;;;;;AAAA,SAASA,aAAT,QAA8B,eAA9B;AACA,SAASC,YAAT,QAA6B,sBAA7B;AACA,OAAOC,SAAP,MAAsB,iBAAtB;AACA,SACEC,QADF,EAEEC,WAFF,EAGEC,oBAHF,QAIO,UAJP;AAMA,OAAO,IAAMC,SAAS,GAAG,SAAlB;AAEP,IAAMC,IAAI,GAAGN,YAAY,CAACO,KAAb,EAAb;AAEA,OAAO,IAAMC,YAAY,GAAG;AAC1BC,EAAAA,IAAI,EAAE,SADoB;AAE1BC,EAAAA,SAAS,EAAE,sBAFe;AAG1BC,EAAAA,QAAQ,EAAEL,IAHgB;AAI1BM,EAAAA,UAAU,EAAGN,IAAI,IAAIO,MAAM,CAACC,IAAP,CAAYR,IAAZ,EAAkBS,MAA3B,GAAqC,CAArC,GAAyC,CAJ3B;AAK1Bd,EAAAA,SAAS,EAAE;AALe,CAArB;AAQP,OAAO,IAAMe,cAAc,GAAGjB,aAAa,uDAGtCG,QAHsC,EAG3B,UAACe,KAAD,EAAQC,MAAR,EAAmB;AAAA,MACrBZ,IADqB,GACZY,MAAM,CAACC,OADK,CACrBb,IADqB;AAE7B,MAAIc,MAAM,GAAG,CAAb;;AACA,MAAId,IAAI,IAAIO,MAAM,CAACC,IAAP,CAAYR,IAAZ,EAAkBS,MAA9B,EAAsC;AACpCf,IAAAA,YAAY,CAACqB,IAAb,CAAkBf,IAAlB;AACAc,IAAAA,MAAM,GAAG,CAAT;AACD,GAN4B,CAO7B;;;AACA,yCAAYH,KAAZ;AAAmBL,IAAAA,UAAU,EAAEQ,MAA/B;AAAuCT,IAAAA,QAAQ,EAAEL;AAAjD;AACD,CAZsC,mCActCH,WAdsC,EAcxB,UAACc,KAAD,EAAW;AACxBjB,EAAAA,YAAY,CAACsB,MAAb;AACAC,EAAAA,OAAO,CAACC,KAAR,iCAAmBP,KAAnB;AAA0BL,IAAAA,UAAU,EAAE,CAAtC;AAAyCD,IAAAA,QAAQ,EAAE,IAAnD;AAAyDV,IAAAA,SAAS,EAAE;AAApE;AACA,yCAAYgB,KAAZ;AAAmBL,IAAAA,UAAU,EAAE,CAA/B;AAAkCD,IAAAA,QAAQ,EAAE,IAA5C;AAAkDV,IAAAA,SAAS,EAAE;AAA7D;AACD,CAlBsC,mCAoBtCG,oBApBsC,EAoBf,UAACa,KAAD,EAAQC,MAAR,EAAmB;AAAA,aAChBA,MAAM,CAACC,OAAP,IAAkB,EADF;AAAA,MACjCM,YADiC,QACjCA,YADiC;;AAEzCF,EAAAA,OAAO,CAACG,GAAR,CAAYR,MAAZ,EAAoB,aAApB;AACA,MAAMS,IAAI,GAAG1B,SAAS,CAAC2B,MAAV,CAAiB,UAAAC,IAAI;AAAA,WAAIA,IAAI,CAACC,UAAL,IAAmBL,YAAvB;AAAA,GAArB,CAAb;AACAF,EAAAA,OAAO,CAACC,KAAR,iCAAoBP,KAApB;AAA2BhB,IAAAA,SAAS,qBAAO0B,IAAP;AAApC;AACA,yCAAYV,KAAZ;AAAmBhB,IAAAA,SAAS,qBAAO0B,IAAP;AAA5B;AACD,CA1BsC,oBA4BzCnB,YA5ByC,CAApC","sourcesContent":["import { handleActions } from 'redux-actions'\nimport { sessionStore } from '../../../utils/index'\nimport routeList from '../../../routes'\nimport {\n  setLogin,\n  setLoginOut,\n  fetchPermissionRoute,\n} from './action'\n\nexport const namespace = 'account'\n\nconst info = sessionStore.fetch()\n\nexport const defaultState = {\n  temp: 'account',\n  storeTips: 'account store module',\n  userInfo: info,\n  loginState: (info && Object.keys(info).length) ? 1 : 0,\n  routeList: [],\n}\n\nexport const accountReducer = handleActions(\n  {\n    // 登录(真实情况需要经过saga)\n    [setLogin]: (state, action) => {\n      const { info } = action.payload\n      let status = 0\n      if (info && Object.keys(info).length) {\n        sessionStore.save(info)\n        status = 1\n      }\n      // let status = (info && Object.keys(info).length) ? 1 : 0\n      return { ...state, loginState: status, userInfo: info }\n    },\n    // 退出：1.清除用户信息 2.登录状态 3.清除匹配的路由\n    [setLoginOut]: (state) => {\n      sessionStore.remove()\n      console.error({ ...state, loginState: 0, userInfo: null, routeList: [] });\n      return { ...state, loginState: 0, userInfo: null, routeList: [] }\n    },\n    // 获取路由列表\n    [fetchPermissionRoute]: (state, action) => {\n      const { permissionId } = action.payload || {}\n      console.log(action, ' 权限路由匹配成功..')\n      const list = routeList.filter(item => item.permission <= permissionId)\n      console.error( { ...state, routeList: [ ...list ]});\n      return { ...state, routeList: [ ...list ]}\n    },\n  },\n  defaultState\n)\n\n"]},"metadata":{},"sourceType":"module"}